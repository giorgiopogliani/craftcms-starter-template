{"version":3,"sources":["counter/counter.js"],"names":["Redactor","add","translations","en","words","chars","init","app","this","lang","utils","editor","statusbar","start","getElement","on","count","bind","stop","off","remove","characters","spaces","html","_clean","arrWords","split","arrSpaces","match","length","data","broadcast","get","replace","trim","removeInvisibleChars"],"mappings":"AA2EGA,SAzEIC,IAAI,SAAU,UAAW,CACxBC,aAAc,CAChBC,GAAI,CACHC,MAAS,QACTC,MAAS,UAGRC,KAAM,SAASC,GAEXC,KAAKD,IAAMA,EACXC,KAAKC,KAAOF,EAAIE,KAChBD,KAAKE,MAAQH,EAAIG,MACjBF,KAAKG,OAASJ,EAAII,OAClBH,KAAKI,UAAYL,EAAIK,WAGzBC,MAAO,WAEWL,KAAKG,OAAOG,aAClBC,GAAG,8DAA+DP,KAAKQ,MAAMC,KAAKT,OAC1FA,KAAKQ,SAETE,KAAM,WAEYV,KAAKG,OAAOG,aAClBK,IAAI,4BAEZX,KAAKI,UAAUQ,OAAO,SACtBZ,KAAKI,UAAUQ,OAAO,UAEhCJ,MAAO,WAEN,IAAIZ,EAAQ,EAAGiB,EAAa,EAAGC,EAAS,EAEpCC,EADUf,KAAKG,OAAOG,aACPS,OAGnB,GAAa,MADbA,EAAOf,KAAKgB,OAAOD,IAEnB,CACC,IAAIE,EAAWF,EAAKG,MAAM,OACtBC,EAAYJ,EAAKK,MAAM,OAE3BxB,EAAQ,EAAaqB,EAASI,OAAS,EACvCP,EAAS,EAAcK,EAAUE,OAAS,EAE1CR,EAAaE,EAAKM,OAGV,IAAIC,EAAO,CAAE1B,MAAOA,EAAOiB,WAAYA,EAAYC,OAAQA,GAGpEd,KAAKD,IAAIwB,UAAU,UAAWD,GAGrBtB,KAAKI,UAAUX,IAAI,QAASO,KAAKC,KAAKuB,IAAI,SAAW,KAAOF,EAAK1B,OACjEI,KAAKI,UAAUX,IAAI,QAASO,KAAKC,KAAKuB,IAAI,SAAW,KAAOF,EAAKT,aAIrEG,OAAQ,SAASD,GAWtB,OAHAA,GADAA,GADAA,GADAA,GADAA,GADAA,GADAA,EAAOA,EAAKU,QAAQ,cAAe,MACvBA,QAAQ,YAAa,KACrBA,QAAQ,OAAQ,KAChBA,QAAQ,OAAQ,MAChBA,QAAQ,OAAQ,MAChBA,QAAQ,UAAW,MACnBC,OACZX,EAAOf,KAAKE,MAAMyB,qBAAqBZ","file":"counter.js","sourcesContent":["(function($R)\n{\n    $R.add('plugin', 'counter', {\n        translations: {\n    \t\ten: {\n    \t\t\t\"words\": \"words\",\n    \t\t\t\"chars\": \"chars\"\n    \t\t}\n        },\n        init: function(app)\n        {\n            this.app = app;\n            this.lang = app.lang;\n            this.utils = app.utils;\n            this.editor = app.editor;\n            this.statusbar = app.statusbar;\n        },\n        // public\n        start: function()\n        {\n            var $editor = this.editor.getElement();\n            $editor.on('keyup.redactor-plugin-counter paste.redactor-plugin-counter', this.count.bind(this));\n            this.count();\n        },\n        stop: function()\n        {\n            var $editor = this.editor.getElement();\n            $editor.off('.redactor-plugin-counter');\n\n            this.statusbar.remove('words');\n            this.statusbar.remove('chars');\n        },\n\t\tcount: function()\n\t\t{\n\t\t\tvar words = 0, characters = 0, spaces = 0;\n\t\t\tvar $editor = this.editor.getElement();\n\t\t\tvar html = $editor.html();\n\n\t\t\thtml = this._clean(html)\n\t\t\tif (html !== '')\n\t\t\t{\n\t\t\t\tvar arrWords = html.split(/\\s+/);\n\t\t\t\tvar arrSpaces = html.match(/\\s/g);\n\n\t\t\t\twords = (arrWords) ? arrWords.length : 0;\n\t\t\t\tspaces = (arrSpaces) ? arrSpaces.length : 0;\n\n\t\t\t\tcharacters = html.length;\n\t\t\t}\n\n            var data = { words: words, characters: characters, spaces: spaces };\n\n            // callback\n\t\t\tthis.app.broadcast('counter', data);\n\n            // statusbar\n            this.statusbar.add('words', this.lang.get('words') + ': ' + data.words);\n            this.statusbar.add('chars', this.lang.get('chars') + ': ' + data.characters);\n\t\t},\n\n        // private\n        _clean: function(html)\n        {\n\t\t\thtml = html.replace(/<\\/(.*?)>/gi, ' ');\n\t\t\thtml = html.replace(/<(.*?)>/gi, '');\n\t\t\thtml = html.replace(/\\t/gi, '');\n\t\t\thtml = html.replace(/\\n/gi, ' ');\n\t\t\thtml = html.replace(/\\r/gi, ' ');\n\t\t\thtml = html.replace(/&nbsp;/g, '1');\n\t\t\thtml = html.trim();\n\t\t\thtml = this.utils.removeInvisibleChars(html);\n\n\t\t\treturn html;\n        }\n    });\n})(Redactor);"]}