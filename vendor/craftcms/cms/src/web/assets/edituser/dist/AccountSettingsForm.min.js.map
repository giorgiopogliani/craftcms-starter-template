{"version":3,"sources":["edituser/src/AccountSettingsForm.js"],"names":["$","Craft","AccountSettingsForm","Garnish","Base","extend","userId","isCurrent","$actionSpinner","confirmDeleteModal","setSettings","settings","$copyPasswordResetUrlBtn","addListener","defaults","this","handleCopyPasswordResetUrlBtnClick","$deleteBtn","getPasswordResetUrl","postActionRequest","requireElevatedSession","proxy","textStatus","ui","createCopyTextPrompt","value","response","data","showConfirmDeleteModal","addClass","redirect","show","removeClass","DeleteUserModal","contentSummary","deleteModalRedirect","jQuery"],"mappings":"CAAA,SAACA,GAEGC,MAAAC,oBAAAC,QAAAC,KAAAC,OACMH,CAEUI,OADZ,KAEIC,UAFJ,KAKIC,yBALJ,KAOIC,eAPJ,KAUUA,mBAAiBF,KACdD,WAASA,KAGTI,KAAAA,SAAYC,EAAUV,EAAMC,GAE5BU,KAAAA,OAAAA,EACAJ,KAAAA,UAAmBD,EAGnBM,KAAAA,YAAiBD,EAAAA,MAAAA,oBAAmCE,UApBjEC,KAAAH,yBAAAZ,EAAA,2BAwBIgB,KAAAA,eAAkChB,EAAE,mBAChCe,KAAAE,WAAAjB,EAAA,eAzBRe,KAAAF,YAAAE,KAAAH,yBAAA,QAAA,sCA6BIM,KAAAA,YAAqBH,KAAWE,WAAA,QAAA,2BAIxBX,mCAAaA,WAGXa,MAAAA,uBAAkBC,uBAAsCpB,EAAEqB,MAAMN,KAAA,yBAG9DO,oBAAe,WACTC,KAAGC,eAAAA,YAAqB,UAE1BC,IAAOC,EAAQ,CAFnBpB,OAAAS,KAAAT,QAxChBL,MAAAkB,kBAAA,+BAAAQ,EAAA3B,EAAAqB,OAAA,SAAAK,EAAAJ,GAgDIM,KAAAA,eAAmCC,SAAA,UAE3B,YAAKrB,GACCW,MAAAA,GAAkBK,qBAAA,CAA4ClB,MAAAA,MAAAA,EAAAA,MAAAA,2BAAiBmB,MAASC,EAAUJ,QAEhGA,QAGIQ,uBAAenB,WAFnBI,KAAAN,mBA1D5BM,KAAAN,mBAAAsB,QA8DyBhB,KAAAP,eAAAwB,YAAA,UAPL/B,MAAAkB,kBAAA,6BAAA,CAAAb,OAAAS,KAAAT,QAAAN,EAAAqB,OAAA,SAAAK,EAAAJ,GASGP,KAAAP,eAAAqB,SAAA,UACH,YAAKpB,IACRM,KAAAN,mBAAA,IAAAR,MAAAgC,gBAAAlB,KAAAT,OAAA,CACJ4B,eAAAR,EAELI,SAAAf,KAAAJ,SAAAwB,yBACcpB,UADd,CACID,SAAU,CACNqB,oBAAqB,QAvErC,CA0EGC","file":"AccountSettingsForm.min.js","sourcesContent":["(function($) {\n    /** global: Craft */\n    /** global: Garnish */\n    Craft.AccountSettingsForm = Garnish.Base.extend(\n        {\n            userId: null,\n            isCurrent: null,\n\n            $copyPasswordResetUrlBtn: null,\n            $actionSpinner: null,\n\n            confirmDeleteModal: null,\n            $deleteBtn: null,\n\n            init: function(userId, isCurrent, settings) {\n                this.userId = userId;\n                this.isCurrent = isCurrent;\n\n                this.setSettings(settings, Craft.AccountSettingsForm.defaults);\n\n                this.$copyPasswordResetUrlBtn = $('#copy-passwordreset-url');\n                this.$actionSpinner = $('#action-spinner');\n                this.$deleteBtn = $('#delete-btn');\n\n                this.addListener(this.$copyPasswordResetUrlBtn, 'click', 'handleCopyPasswordResetUrlBtnClick');\n                this.addListener(this.$deleteBtn, 'click', 'showConfirmDeleteModal');\n            },\n\n            handleCopyPasswordResetUrlBtnClick: function() {\n                // Requires an elevated session\n                Craft.elevatedSessionManager.requireElevatedSession($.proxy(this, 'getPasswordResetUrl'));\n            },\n\n            getPasswordResetUrl: function() {\n                this.$actionSpinner.removeClass('hidden');\n\n                var data = {\n                    userId: this.userId\n                };\n\n                Craft.postActionRequest('users/get-password-reset-url', data, $.proxy(function(response, textStatus) {\n                    this.$actionSpinner.addClass('hidden');\n\n                    if (textStatus === 'success') {\n                        Craft.ui.createCopyTextPrompt({\n                            label: Craft.t('app', 'Copy the activation URL'),\n                            value: response.url,\n                        });\n                    }\n                }, this));\n            },\n\n            showConfirmDeleteModal: function() {\n                if (!this.confirmDeleteModal) {\n                    this.$actionSpinner.removeClass('hidden');\n                    Craft.postActionRequest('users/user-content-summary', {userId: this.userId}, $.proxy(function(response, textStatus) {\n                        this.$actionSpinner.addClass('hidden');\n                        if (textStatus === 'success') {\n                            this.confirmDeleteModal = new Craft.DeleteUserModal(this.userId, {\n                                contentSummary: response,\n                                redirect: this.settings.deleteModalRedirect\n                            });\n                        }\n                    }, this));\n                } else {\n                    this.confirmDeleteModal.show();\n                }\n            }\n        },\n        {\n            defaults: {\n                deleteModalRedirect: null\n            }\n        });\n})(jQuery);\n"]}