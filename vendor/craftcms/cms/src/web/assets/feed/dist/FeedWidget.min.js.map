{"version":3,"sources":["feed/src/FeedWidget.js"],"names":["$","Craft","FeedWidget","Garnish","Base","extend","$widget","widgetId","addClass","this","url","params","find","response","items","attr","data","direction","i","length","widgetHtml","permalink","$td","$tds","outerHTML","href","item","target","text","title","get","date","formatDate","sendActionRequest","removeClass","catch","cp","displayError","t","jQuery"],"mappings":"CAAA,SAACA,GAEGC,MAAAC,WAAAC,QAAAC,KAAAC,OACMH,CAESI,QADX,KAIaA,KAAL,SAAiBC,EAAYA,EAAAA,GACxBD,KAAQE,QAASR,EAAA,UAEtBO,GAFAE,KAAKH,QAAQE,SAAS,WAKTE,MAAAA,IAAAA,mCAAAA,CADDC,OAAA,CAGID,IAAIA,KAEXJ,KAAQM,IAEFH,KAAKH,QAAQM,YAAxB,WACYC,KAAAA,QAAAD,KAAcE,SAFrBC,KAAK,MAAOF,EAASG,KAAKC,WAIrB,IAAMC,EAAIJ,KAAMK,QAASP,KAAI,MACxBE,EAAXD,EAAAG,KAAAF,OAAA,GAGIM,IAAU,IAAKF,EAAA,EAADA,EAASJ,EAAAK,OAAAD,IAAA,CACZG,IAAAA,EADYP,EAAAI,GAAAI,EAAAtB,EAAAuB,EAAAL,IAIjBM,IAAAA,EAJVxB,EAAA,OAAA,CACIyB,KAAMC,EAAKL,UAKAM,OAAA,SACGC,KAAAF,EAAAG,QACjBC,IAAA,GAAAN,UAAA,IAEQJ,EAATW,OAGJX,GAAA,8BAAAnB,MAAA+B,WAAAN,EAAAK,MAAA,WACME,EAAAA,KAAkBb,GACdnB,MAAAgC,kBAAA,OAAA,4BAAA,CADVjB,KAAA,CAMWN,IAAAA,EACEwB,KAAYrB,EAAzBG,UAGPmB,MAAA,KAhDT1B,KAAAH,QAAA4B,YAAA,WAHJjC,MAAAmC,GAAAC,aAAApC,MAAAqC,EAAA,MAAA,iCAAA,CAqDGC","file":"FeedWidget.min.js","sourcesContent":["(function($) {\n    /** global: Craft */\n    /** global: Garnish */\n    Craft.FeedWidget = Garnish.Base.extend(\n        {\n            $widget: null,\n\n            init: function(widgetId, url, limit) {\n                this.$widget = $('#widget' + widgetId);\n                this.$widget.addClass('loading');\n\n                // Get the feed data\n                axios.get('https://feed-proxy.craftcms.com/', {\n                    params: {\n                        url: url,\n                    },\n                }).then(response => {\n                    this.$widget.removeClass('loading');\n                    this.$widget.find('table')\n                        .attr('dir', response.data.direction);\n                    let $tds = this.$widget.find('td');\n                    let items = response.data.items || [];\n\n                    for (let i = 0; i < items.length; i++) {\n                        let item = items[i];\n                        let $td = $($tds[i]);\n\n                        var widgetHtml = $('<a/>', {\n                            href: item.permalink,\n                            target: '_blank',\n                            text: item.title\n                        }).get(0).outerHTML + ' ';\n\n                        if (item.date) {\n                            widgetHtml += '<span class=\"light nowrap\">' + Craft.formatDate(item.date) + '</span>';\n                        }\n\n                        $td.html(widgetHtml);\n                    }\n\n                    // Now cache the data\n                    Craft.sendActionRequest('POST', 'dashboard/cache-feed-data', {\n                        data: {\n                            url: url,\n                            data: response.data,\n                        },\n                    });\n                }).catch(() => {\n                    this.$widget.removeClass('loading');\n                    Craft.cp.displayError(Craft.t('app', 'Could not load the feed'));\n                });\n            }\n        });\n})(jQuery);\n"]}